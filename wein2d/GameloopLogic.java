package wein2d;

class GameloopLogic
{
    // Variables ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    private Gameloop gameloop;
    protected int fps = 60;
    private boolean running;
    private long lastFrameTime;
    // Constructor ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    GameloopLogic(Gameloop givenGameloop) {
        gameloop = givenGameloop;
    }
    // Start ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    protected void start()
    {
        running = true;
        gameloop();
    }
    // Gameloop ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    private void gameloop()
    {
        long frameStartTime;
        long frameTime;
        long waitTime;
        while (running)
        {
            // get Time at start of Frame
            frameStartTime = System.currentTimeMillis();
            // call methods
            gameloop.onFrame((double) ((System.currentTimeMillis() - (double) lastFrameTime) * 1000));
            lastFrameTime = System.currentTimeMillis();
            // calculate amount of sleep
            frameTime = System.currentTimeMillis() - frameStartTime;
            waitTime = 1000 / fps - frameTime;
            // sleep
            try
            {
                Thread.sleep(waitTime);
            }
            catch (Exception e) { e.printStackTrace(); }
        }
    }
}
