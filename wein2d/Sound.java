package wein2d;

import javax.sound.sampled.*;
import java.io.File;

public class Sound
{
    // Variables ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    private Clip sound;
    private long pausedTime;
    // Constructor ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    public Sound(String filePath)
    {
        // store full path as string
        String fullFilePath = System.getProperty("user.dir") + "/" + filePath;
        // replace all leftover backslashes with foreward slashes
        fullFilePath = fullFilePath.replace("\\", "/");
        // print if the image does even exist
        if (!(new File(fullFilePath).exists()))
        {
          System.out.println("Error when loading a sound: sound at '" + fullFilePath + "' doesn't exist.");
        }
        try
        {
            // load file into audioInputStream
            AudioInputStream audioInputStream = AudioSystem.getAudioInputStream(new File(fullFilePath).getAbsoluteFile());
            // create Clip and load audioInputStream into it
            sound = AudioSystem.getClip();
            sound.open(audioInputStream);
        }
        catch (Exception fileLoadingException)
        {
            // print if error
            System.out.println("Error: Something went wrong when loading the Sound at '" + fullFilePath + "'.");
        }
    }
    // Play ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    public void play()
    {
        sound.start();
    }
    // Loop ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    public void loop(int times)
    {
        if (times == 0)
        {
            sound.loop(Clip.LOOP_CONTINUOUSLY);
        }
        else if (times > 0)
        {
            sound.loop(times);
        }
    }
    // Stop ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    public void stop()
    {
        sound.stop();
    }
    // Pause ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    public void pause()
    {
        pausedTime = sound.getMicrosecondPosition();
        sound.stop();
    }
    // Resume ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    public void resume()
    {
        sound.setMicrosecondPosition(pausedTime);
        sound.start();
    }
}
